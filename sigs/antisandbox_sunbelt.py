from abstracts import Signature
from threemon.reader import EventTypes
from threemon import registry_pb2

class SunBeltSandboxDetect(Signature):
    event_types = [EventTypes.REGISTRY]

    description = "Tries to detect SunBelt Sandbox"
    TTPS = ["T1083", "T1057"]

    dlls = [
        "api_log.dll",
        "api_log",
        "dir_watch.dll",
        "dir_watch",
    ]

    #Skipped for now, since it's not clear yet, what kind of registry are to 
    #be expected
    #def wants_event(self, registry_event):

    #Is there a differnt way to detect API calls in Cuckoo logs besides checking 
    #for certain registry key events?
    def registry_event(self, registry):
        for self.dlls in registry.path:
            self.trigger()
