from abstracts import Signature
from threemon.reader import EventTypes
from threemon import file_pb2
from report import mapping

# Original Signature:
# https://github.com/cuckoosandbox/community/blob/master/modules/signatures/windows/emoves_zoneid_ads.py

class RemovesZoneIdADS(Signature):

    event_types = {
        EventTypes.FILE: {file_pb2.Delete, file_pb2.DeleteDelayed}
    }

    description = "Attempts to remove evidence of file being downloaded from the Internet"
    TTPS = ["T1070", "T1096"]
    events = {}

    def file_event(self, file):
        if file.srcpath.endswith(":Zone.Identifier"):
            self.events = mapping(self.events, file)
            self.trigger()
