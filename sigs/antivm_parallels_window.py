# Not suiteable for Cuckoo3
# Original file:

"""
class ParallelsDetectWindow(Signature):
    name = "antivm_parallels_window"
    description = "Detects Parallels through the presence of a window"
    severity = 3
    categories = ["anti-vm"]
    authors = ["Kevin Ross"]
    minimum = "2.0"
    ttp = ["T1057"]

    filter_categories = "ui",

    # Lowercase all indicators.
    indicators = [indicator.lower() for indicator in [
        "prl_cc.exe",
        "prl_tools.exe",
    ]]

    def on_call(self, call, process):
        for indicator in self.indicators:
            window_name = call["arguments"].get("window_name", "").lower()
            class_name = call["arguments"].get("class_name", "").lower()

            if indicator == window_name or indicator == class_name:
                self.mark_call()

    def on_complete(self):
        return self.has_marks()
    """