from abstracts import Signature
from threemon.reader import EventTypes
from threemon import process_pb2

class AntiVMSharedDevice(Signature):

    event_types = [EventTypes.PROCESS]

    description = "Attempts to detect a virtual machine by the use of a pseudo device"
    TTPS = ["1082"]


    def wants_event(self, process_event):
        if process_event.status == process_pb2.Create:
            return True
        return False

    def process_event(self, process):
        if process.image.endswith(("\\hgfs", "\\vmci")):
            self.trigger()
