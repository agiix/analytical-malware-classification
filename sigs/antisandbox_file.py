from abstracts import Signature
from threemon.reader import EventTypes
from threemon import file_pb2

# Original Signature:
# https://github.com/cuckoosandbox/community/blob/master/modules/signatures/windows/antisandbox_file.py

class AntiSandboxFile(Signature):

    event_types = {
        EventTypes.FILE: {file_pb2.OpenRead}
    }

    description = "Looks for known filepaths where sandboxes execute samples"
    TTPS = ["None"]

    file_indicators = [
        ":\\sample\\.exe",
        ":\\malware\\.exe",
    ]

    def file_event(self, file):
        if file.srcpath[0].isalpha():
            for i in self.file_indicators:
                if i in file.srcpath:
                    self.trigger()
    

