# Revenge


<table>
<tr><th>Windows 10 </th><th></th><th>Windows 7</th></tr>
<tr><td>

| Operation log categories| Counted entries|
| :---------     | ----------:   |
| Autogen       | 0             |
| Debug         | 0             |
| File          | 3673          |    
| Inject        | 0             |      
| Mutant        | 24            |
| NetworkFlow   | 16            |
| NetworkListen | 10            |
| Notifications | 0             |
| Process       | 109           |
| Registry      | 13963         |
| Suspicious    | 90            |
| Thread        | 0             |
| VmInfo        | 1             |
| Whois         | 1             |

</td><td></td><td>

| Operation log categories| Counted entries|
| :---------     | ----------:   |
| Autogen       | 0             |
| Debug         | 0             |
| File          | 4575          |    
| Inject        | 0             |      
| Mutant        | 4           |
| NetworkFlow   | 14            |
| NetworkListen | 11            |
| Notifications | 0             |
| Process       | 62            |
| Registry      | 17545         |
| Suspicious    | 55            |
| Thread        | 0             |
| VmInfo        | 1             |
| Whois         | 1             |

</td></tr> </table>

## Additional Findings
**Windows 10**
* Uses the commands 'vssadmin.exe delete shadows /all /Quiet' and 'wmic  shadowcopy delete' to delete shadow copies.
* 97 file deletions have been logged, the samples seems to copy the content of the original file to a new one, with a hash values as it's filename and add's an .REVENGE suffix to it. For example: 'EBEC069C1C9B74EAFB91AFBF9C2D7710.REVENGE'
* Uses QueryValueKey to obtain information from '..MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid' which is often used as a unique identifier for a machine. This specific operations occurs 815 times in the sample. [More Information](https://wikileaks.org/ciav7p1/cms/page_42991626.html)
* Uses QueryValueKey to open the '..\\Microsoft\\Cryptography\\Defaults\\Provider Types\\Type 001' (points to Microsoft Strong Cryptographic Provider) and '..\\Microsoft\\Cryptography\\Defaults\\Provider\\Microsoft Strong Cryptographic Provider\\' registry key, which is used as the default RSA Full cryptographic service provider (CSP). It supports all of the algorithms of the Microsoft Enhanced Cryptographic Provider and all of the same key lengths. It can be used with all versions of CryptoAPI. More information [here](https://docs.microsoft.com/en-us/windows/win32/seccrypto/microsoft-strong-cryptographic-provider) and [here](https://docs.microsoft.com/en-us/windows/win32/seccrypto/microsoft-enhanced-cryptographic-provider)

**Windows 7**
* Uses the commands 'vssadmin.exe delete shadows /all /Quiet' to delete shadow copies.
* 136 file deletions have been logged, the samples seems to copy the content of the original file to a new one, with a hash values as it's filename and add's an .REVENGE suffix to it. For example: '9184A6061C9B74EAFB91AFBF65816B11.REVENGE
* Uses QueryValueKey to obtain information from '..MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid' which is often used as a unique identifier for a machine. This specific operations occurs 892 times in the sample. [More Information](https://wikileaks.org/ciav7p1/cms/page_42991626.html )
* Uses QueryValueKey to optain information about the '..\\Microsoft\\Cryptography\\Defaults\\Provider Types\\Type 024' (points to Microsoft Enhanced RSA and AES Cryptographic Provider) and '..Microsoft\\Cryptography\\Defaults\\Provider\\Microsoft Enhanced RSA and AES Cryptographic Provider' registry key. The AES Provider supports stronger security through longer keys and additional algorithms. It can be used with all versions of CryptoAPI. [More Information](https://docs.microsoft.com/en-us/windows/win32/seccrypto/microsoft-aes-cryptographic-provider#:~:text=The%20Microsoft%20Enhanced%20RSA%20and,with%20all%20versions%20of%20CryptoAPI.)
