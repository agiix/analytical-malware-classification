# Dharma Family - 0aaad9fd6d9de6a189e89709e052f06b


<table>
<tr><th>Windows 10 </th><th></th><th>Windows 7</th></tr>
<tr><td>

| Operation log categories| Counted entries|
| :---------     | ----------:   |
| Autogen       | 0             |
| Debug         | 0             |
| File          | 103881        |    
| Inject        | 0             |      
| Mutant        | 38            |
| NetworkFlow   | 240           |
| NetworkListen | 7             |
| Notifications | 0             |
| Process       | 94            |
| Registry      | 1796          |
| Suspicious    | 585           |
| Thread        | 0             |
| VmInfo        | 1             |
| Whois         | 1             |

</td><td></td><td>

| Operation log categories| Counted entries|
| :---------     | ----------:   |
| Autogen       | 0             |
| Debug         | 0             |
| File          | 67649         |    
| Inject        | 0             |      
| Mutant        | 18            |
| NetworkFlow   | 28            |
| NetworkListen | 4             |
| Notifications | 0             |
| Process       | 45            |
| Registry      | 2420          |
| Suspicious    | 320           |
| Thread        | 0             |
| VmInfo        | 1             |
| Whois         | 1             |

</td></tr> </table>

## Additional Findings
**Windows 10**
* Uses the commands 'vssadmin.exe delete shadows /all /Quiet' and 'wmic  shadowcopy delete' to delete shadow copies.
* 12693 file deletions have been logged, the content is being copied to a new file which will be encrypted and will contain the original filename with the "id-8203BE1F.\[who8@mail.fr\].aa1" (probably a unique ID generated for every victim) suffix appended.
* Executables and dll's are directly encrypted and reanamed, instead of the content getting copied to a new file which will be encrypted and renamed while the original file get's deleted.

**Windows 7**
* Uses the commands 'vssadmin.exe delete shadows /all /Quiet' to delete shadow copies.
* 9497 file deletions have been logged, the content is being copied to a new file which will be encrypted and will contain the original filename with the "id-D9D896E7.[who8@mail.fr].aa1 (probably a unique ID generated for every victim) suffix appended.
* Dll's, .cap and .msi files are directly encrypted and reanamed, instead of the content getting copied to a new file which will be encrypted and renamed while the original file get's deleted.
* Uses QueryValueKey to obtain information from '..MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid' which is often used as a unique identifier for a machine. This specific operations occurs 892 times in the sample. [More Information](https://wikileaks.org/ciav7p1/cms/page_42991626.html )
* Uses QueryValueKey to open the '..\\Microsoft\\Cryptography\\Defaults\\Provider\\Microsoft Strong Cryptographic Provider\\' registry key, which is used as the default RSA Full cryptographic service provider (CSP). It supports all of the algorithms of the Microsoft Enhanced Cryptographic Provider and all of the same key lengths. It can be used with all versions of CryptoAPI. More information [here](https://docs.microsoft.com/en-us/windows/win32/seccrypto/microsoft-strong-cryptographic-provider) and [here](https://docs.microsoft.com/en-us/windows/win32/seccrypto/microsoft-enhanced-cryptographic-provider)
* Uses QueryValueKey to open the '..Microsoft\\Cryptography\\PrivKeyCacheMaxItems' registry key, which specifies the maximum number of private keys that can be cached at one time for a single process. [More Information](https://docs.microsoft.com/en-us/windows/win32/seccrypto/private-key-caching-constants#szPRIV_KEY_CACHE_MAX_ITEMS)
* Uses QueryValueKey to open the '..Microsoft\\Cryptography\\PrivKeyCachePurgeIntervalSeconds' registry key, which specifies the maximum age, in seconds, of any cached private key. [More Information](https://docs.microsoft.com/en-us/windows/win32/seccrypto/private-key-caching-constants#szPRIV_KEY_CACHE_PURGE_INTERVAL_SECONDS)
* Uses QueryValueKey to open the '..Microsoft\\Cryptography\\PrivateKeyLifetimeSeconds' registry key, which specifies the maximum age, in seconds, of any cached private key. [More Information](https://docs.microsoft.com/en-us/windows/win32/seccrypto/private-key-caching-constants#szKEY_CACHE_SECONDS)
