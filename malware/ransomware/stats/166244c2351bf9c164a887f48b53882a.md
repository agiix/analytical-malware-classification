# Teslacrypt


<table>
<tr><th>Windows 10 </th><th></th><th>Windows 7</th></tr>
<tr><td>

| Operation log categories| Counted entries|
| :---------     | ----------:   |
| Autogen       | 0             |
| Debug         | 0             |
| File          | 23285         |    
| Inject        | 0             |      
| Mutant        | 80            |
| NetworkFlow   | 344           |
| NetworkListen | 44            |
| Notifications | 0             |
| Process       | 99            |
| Registry      | 15212         |
| Suspicious    | 546           |
| Thread        | 0             |
| VmInfo        | 1             |
| Whois         | 1             |

</td><td></td><td>

| Operation log categories| Counted entries|
| :---------     | ----------:   |
| Autogen       | 0             |
| Debug         | 0             |
| File          | 9285          |    
| Inject        | 0             |      
| Mutant        | 30            |
| NetworkFlow   | 370           |
| NetworkListen | 44            |
| Notifications | 0             |
| Process       | 51            |
| Registry      | 15359         |
| Suspicious    | 398           |
| Thread        | 0             |
| VmInfo        | 1             |
| Whois         | 1             |

</td></tr> </table>

## Additional Findings
**Windows 10**
* Uses the command: 'vssadmin.exe delete shadows /all /Quiet' to delete shadow copies.
* 928 file reanamings and 10 file deletions have been logged, indicating the behavior that the original file will be encrypted and not deleted, contrary to other common ransomware behavior, where the file content is being copied into another file, encrypted and then original file deleted. 
* Queries the registry key '..\\Microsoft\\Cryptography\\DRM_RNG\\Seed' to obtain random Bytes as seed in order to compute cryptrographic keys.
* Uses QueryValueKey to obtain information from '..MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid' which is often used as a unique identifier for a machine. This specific operations occurs 815 times in the sample. [More Information](https://wikileaks.org/ciav7p1/cms/page_42991626.html)
* Uses OpenKeyEx to open the '..\\Microsoft\\Cryptography\\Defaults\\Provider Types\\Type 001' (points to Microsoft Strong Cryptographic Provider) and '\\Microsoft\\Cryptography\\Defaults\\Provider\\Microsoft Strong Cryptographic Provider\\' registry key, which is used as the default RSA Full cryptographic service provider (CSP). It supports all of the algorithms of the Microsoft Enhanced Cryptographic Provider and all of the same key lengths. It can be used with all versions of CryptoAPI. More information [here](https://docs.microsoft.com/en-us/windows/win32/seccrypto/microsoft-strong-cryptographic-provider) and [here](https://docs.microsoft.com/en-us/windows/win32/seccrypto/microsoft-enhanced-cryptographic-provider)


**Windows 7**
* Uses the command: 'vssadmin.exe delete shadows /all /Quiet' to delete shadow copies.
* 854 file reanamings and 11 file deletions have been logged, indicating the behavior that the original file will be encrypted and not deleted, contrary to other common ransomware behavior, where the file content is being copied into another file, encrypted and then original file deleted. 
* Queries the registry key '..\\Microsoft\\Cryptography\\RNG\\Seed' to obtain 64 random Bytes as seed in order to compute cryptrographic keys. The seed is being constantly updated.(See "Practical Malware Analysis" by Michael Sikorski and Andrew Honig) 
* Uses QueryValueKey to obtain information from '..MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid' which is often used as a unique identifier for a machine. This specific operations occurs 892 times in the sample. [More Information](https://wikileaks.org/ciav7p1/cms/page_42991626.html )
* Uses OpenKeyEx to open the '..\\Microsoft\\Cryptography\\Defaults\\Provider Types\\Type 001' (points to Microsoft Strong Cryptographic Provider) and '\\Microsoft\\Cryptography\\Defaults\\Provider\\Microsoft Strong Cryptographic Provider\\' registry key, which is used as the default RSA Full cryptographic service provider (CSP). It supports all of the algorithms of the Microsoft Enhanced Cryptographic Provider and all of the same key lengths. It can be used with all versions of CryptoAPI. More information [here](https://docs.microsoft.com/en-us/windows/win32/seccrypto/microsoft-strong-cryptographic-provider) and [here](https://docs.microsoft.com/en-us/windows/win32/seccrypto/microsoft-enhanced-cryptographic-provider)
