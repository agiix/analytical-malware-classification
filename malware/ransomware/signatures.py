import json
import base64

"""
line would contain a onemon entry of the category "*onemon.FileContents" and would be passed to ransomNote for further investigation
ransomwNote checks for "buf", decodes it and looks for certain strings
"""
def ransomNote(line):
    x = json.loads(line)
    if x.get('event', {}).get('buf') is not None:
        note = base64.b64decode(x.get('event', {}).get('buf'))
        #This matchings are pretty weak, since malware would only need to change one character to bypass detection
        if note.find(b'encrypted') > 0 or note.find(b'decrypted') > 0 or note.find(b'bitcoin') > 0 or \
            note.find(b'decryption') > 0 or note.find(b'encrypttion') > 0:
            return True
    return False
