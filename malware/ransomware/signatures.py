import base64

"""line would contain a onemon entry of the category "*onemon.FileContents" 
and would be passed to ransomNote for further investigation
ransomwNote checks for "buf", decodes it and looks for certain strings"""

# This matchings are pretty weak, since malware would only need to change
# one character to bypass detection
ransomtokens = (b"encrypted", b"decrypted",
                b"bitcoin", b"decryption", b"encryption")

def ransomNote(line):
    if line.get('event', {}).get('buf') is not None:
        note = base64.b64decode(line.get('event', {}).get('buf'))

        for token in ransomtokens:
            if token in note:
                return True

    return False

event_sigs = {
    "*onemon.FileContents": [ransomNote]
}
