# Ransomware

### Crypto API calls
Detecting API calls to cryptographic functionality is a popular and effective way to detect ransomware behavior. 
Windowâ€™s CryptoAPI and its functions CryptEncrypt and CryptHashData are commonly used.

### File deletion/removal
Ransomware tends to copy the content of a file it wants to encrypt to a new file before encrypting it. The original file is then deleted. If a significant amount of user data is deleted, it could indicate ran- somware or wiper malware activity.

### File extension modification
Most ransomware changes the files suffix after encryption. By com- paring the new suffix to a list of suffixes previously used, it may be possible to attribute the sample to a specific ransomware family.

### Frequency of file system calls
Ransomware might avoid using system calls to encryption algorithms, but it cannot avoid calls for opening, reading, and writing to files. All ransomware strains attempt to encrypt as many files as possible in the shortest amount of time. They produce a pattern of frequent file system operations, which are unique to ransomware.
 
### Frequency of accessed directories
Unlike benign applications, ransomware accesses a large amount of directories in a short period of time.

### Deleting shadow copies
Most variants of ransomware use the vssadmin tool to delete all volume shadow copies, in order to avoid the recovery of the encrypted files.

### Locking mechanisms
This behavior is more characteristic for locker ransomware than crypto ransomware. Locking the systems desktop often involves a sequence of GetThreadDesktop, CreateDesktopW and SwitchDesktop func- tions. Other locking mechanisms include the usage of native APIs to lock the system. However, the implementation of this locking mechanism requires significant work, since native APIs are not prop- erly documented and may change among different versions, which can limit the portability of the malware. Other methods include the manipulation of the master boot record.

### Registry key operations
Research has shown that certain registry key operations can be used to successfully detect ransomware. Furthermore, this approach promises to be more precise than API signatures. 

### File differences
Files that have been encrypted will not share any similar content to the original unencrypted file. By comparing the similarity with, for example, a similarity hash, one can distinguish encryption from a regular file modification. To avoid false positives, this approach should be combined with checking the entropy level.


