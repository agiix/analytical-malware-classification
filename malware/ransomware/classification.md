# Ransomware

## Suitable for Cuckoo Signatures

| Behavior | Description |
| ----------- | ----------- |
| Registry key operations | Research has shown that certain registry key operations can be used to successfully detect ransomware. Furthermore, this approach promises to be more precise than API signatures. |
| File deletion/removal | Ransomware tends to copy the content of a file it wants to encrypt to a new file before encrypting it. The original file is then deleted. If a significant amount of user data is deleted, it could indicate ransomware or wiper malware activity. |
| File extension modification | Most ransomware changes the files suffix after encryption. By comparing the new suffix to a list of suffixes previously used, it may be possible to attribute the sample to a specific ransomware family. |
| Frequency of accessed directories | Unlike benign applications, ransomware accesses a large amount of directories in a short period of time. |
| Deleting shadow copies | Most variants of ransomware use the vssadmin tool to delete all volume shadow copies, in order to avoid the recovery of the encrypted files. |

## Not Suitable for Cuckoo Signatures, but still valueable for classification

| Behavior | Description |
| ----------- | ----------- |
| Crypto API calls | Detecting API calls to cryptographic functionality is a popular and effective way to detect ransomware behavior. Windowâ€™s CryptoAPI and its functions CryptEncrypt and CryptHashData are commonly used. |
| Modification of the Magic Byte | Usually file modification changes only the content of the file, not the file format that is defined at the beginning of the file. The encryption process in ransomware tends to modify not only the content of the file but also the file format, therefore modifying the magic bytes. This can be a potential indicator for ransomware but is prone to false positives, since common file formats modify this section as well. |
| Frequency of file system calls | Ransomware might avoid using system calls to encryption algorithms, but it cannot avoid calls for opening, reading, and writing to files. All ransomware strains attempt to encrypt as many files as possible in the shortest amount of time. They produce a pattern of frequent file system operations, which are unique to ransomware. |
| Locking mechanisms | This behavior is more characteristic for locker ransomware than crypto ransomware. Locking the systems desktop often involves a sequence of GetThreadDesktop, CreateDesktopW and SwitchDesktop func- tions. Other locking mechanisms include the usage of native APIs to lock the system. However, the implementation of this locking mechanism requires significant work, since native APIs are not prop- erly documented and may change among different versions, which can limit the portability of the malware. Other methods include the manipulation of the master boot record. |
| File differences | Files that have been encrypted will not share any similar content to the original unencrypted file. By comparing the similarity with, for example, a similarity hash, one can distinguish encryption from a regular file modification. To avoid false positives, this approach should be combined with checking the entropy level. |
| Unique IRP function calls | I/O request packets are used by the Windows driver model to com- municate with each other and the operating system. Not only are these patterns unique to ransomware behavior, but depending on how the ransomware encrypts files, it is possible to differentiate between the different ransomware families.|
| Entropy | When a file is being encrypted, the randomness of occurring charac- ters rises significantly. Therefore, metrics like the entropy level can be used to detect, whether a modification to a file was benign or ma- licious. The challenge for implementing an entropy check is to find the ideal threshold. This approach is sensitive to false positives if not implemented correctly since many file formats use compression techniques which could be falsely interpreted as encryption. |
| Black listed domain names | DNS queries resolving domain names that have already been used in ransomware in the past, can be used for ransomware classification |
| Detection of dynamically generated domain names | To avoid the black listing of known malicious domains, particular types of ransomware create a list of domains with a domain genera- tion algorithm and send dns queries to resolve them. The frequency of the dns queries as well as the randomness of the requested domain names can be used to detect this behavior. |


